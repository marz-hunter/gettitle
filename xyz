Title:         AWS subdomain Takeover at estore.razersynapse.com
Scope:         Razer web properties NOT in Group 1 (as listed)
Weakness:      Privilege Escalation
Severity:      Medium
Link:          https://hackerone.com/reports/785179
Date:          2020-01-29 01:01:20 +0000
By:            @marzuki1337

Details:
##summary
I found aws subdomain takeover * razersynapse.com seems to be included in the scope after I saw the report  `https://hackerone.com/reports/736273`

I did a takeover along with a functioning poc so this is not a false positive because I also uploaded the poc to the subdomain

##PoC:
`https://estore.razersynapse.com/marz.html`

##takeover steps:
1.Go to S3 panel
2.Click Create Bucket
3.Set Bucket name to source domain name (i.e., the domain you want to take over from error)
4.Click Next multiple times to finish
5.Open the created bucket
6.Click Upload
7.Select the file which will be used for PoC (HTML or TXT file). I recommend naming it differently than index.html; you can use poc (without extension)
8.In Permissions tab select Grant public read access to this object(s)
9.After upload, select the file and click More -> Change metadata
10.Click Add metadata, select Content-Type and value should reflect the type of document. If HTML, choose text/html, etc.
11.(Optional) If the bucket was configured as a website
12.Switch to Properties tab
13.Click Static website hosting
14.Select Use this bucket to host a website
15.As an index, choose the file that you uploaded
16.Click Save

## Impact

stealing user cookies, hosting any content on this subdomain,
`https://0xpatrik.com/subdomain-takeover/`

